{"ast":null,"code":"import _asyncToGenerator from\"D:/CURSO JS/REACT/instagram/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/CURSO JS/REACT/instagram/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\CURSO JS\\\\REACT\\\\instagram\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";/* eslint-disable import/named */ /* eslint-disable no-shadow */ /* eslint-disable no-restricted-globals */ /* eslint-disable react/no-unescaped-entities */ /* eslint-disable no-unused-vars */import React,{useState,useContext,useEffect}from\"react\";import{Link,useNavigate}from\"react-router-dom\";import FirebaseContext from\"../context/firebase\";import*as ROUTES from\"../constants/routes\";import{doesUsernameExists}from\"../services/firebase\";import\"firebase/compat/auth\";import{firebase,FieldValue}from\"../lib/firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SignUp(){var history=useNavigate();// const { firebase } = useContext(FirebaseContext);\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),fullName=_useState4[0],setFullName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),emailAddress=_useState6[0],setEmailAddress=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var isInvalid=password===\"\"||emailAddress===\"\";var handleSignUp=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var usernameExists,createdUserResult;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.next=3;return doesUsernameExists(username);case 3:usernameExists=_context.sent;console.log(\"usernameExists\",usernameExists);if(usernameExists){_context.next=25;break;}_context.prev=6;_context.next=9;return firebase.auth().createUserWithEmailAndPassword(emailAddress,password);case 9:createdUserResult=_context.sent;_context.next=12;return createdUserResult.user.updateProfile({displayName:username});case 12:_context.next=14;return firebase.firestore().collection(\"users\").add({userId:createdUserResult.user.uid,username:username.toLowerCase(),fullName:fullName,emailAddress:emailAddress.toLowerCase(),following:[\"2\"],followers:[],dateCreated:Date.now()});case 14:history(ROUTES.DASHBOARD);_context.next=23;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](6);setFullName(\"\");setEmailAddress(\"\");setPassword(\"\");setError(_context.t0.message);case 23:_context.next=27;break;case 25:setUsername(\"\");setError(\"That username is already taken, please try another.\");case 27:case\"end\":return _context.stop();}}},_callee,null,[[6,17]]);}));return function handleSignUp(_x){return _ref.apply(this,arguments);};}();useEffect(function(){document.title=\"Sign Up - Instagram\";},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container flex justify-center mx-auto max-w-screen-md items-center h-screen\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex w-3/5 hidden sm:block\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/images/iphone-with-profile.jpg\",alt:\"iPhone with Instagram app\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-4/5 sm:w-2/5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center bg-white p-4 border border-gray-primary mb-4 rounded\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"flex justify-center w-full\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/images/logo.png\",alt:\"Instagram\",className:\"mt-2 w-6/12 mb-4\"})}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"mb-4 text-xs text-red-primary\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSignUp,method:\"POST\",children:[/*#__PURE__*/_jsx(\"input\",{\"aria-label\":\"Enter your username\",type:\"text\",placeholder:\"Username\",className:\"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2\",onChange:function onChange(_ref2){var target=_ref2.target;return setUsername(target.value);},value:username}),/*#__PURE__*/_jsx(\"input\",{\"aria-label\":\"Enter your full name\",type:\"text\",placeholder:\"Full name\",className:\"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2\",onChange:function onChange(_ref3){var target=_ref3.target;return setFullName(target.value);},value:fullName}),/*#__PURE__*/_jsx(\"input\",{\"aria-label\":\"Enter your email address\",type:\"text\",placeholder:\"Email address\",className:\"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2\",onChange:function onChange(_ref4){var target=_ref4.target;return setEmailAddress(target.value);},value:emailAddress}),/*#__PURE__*/_jsx(\"input\",{\"aria-label\":\"Enter your password\",type:\"password\",placeholder:\"Password\",className:\"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2\",onChange:function onChange(_ref5){var target=_ref5.target;return setPassword(target.value);},value:password}),/*#__PURE__*/_jsx(\"button\",{disabled:isInvalid,type:\"submit\",className:\"bg-blue-medium text-white w-full rounded h-8 font-bold\\n            \".concat(isInvalid&&\"opacity-50\"),children:\"Sign Up\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center flex-col w-full bg-white p-4 rounded border border-gray-primary\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm\",children:[\"\\xBFHave an account?\",\" \",/*#__PURE__*/_jsx(Link,{to:ROUTES.LOGIN,className:\"font-bold text-blue-medium\",children:\"Login\"})]})})]})]});}","map":{"version":3,"sources":["D:/CURSO JS/REACT/instagram/src/pages/sign-up.js"],"names":["React","useState","useContext","useEffect","Link","useNavigate","FirebaseContext","ROUTES","doesUsernameExists","firebase","FieldValue","SignUp","history","username","setUsername","fullName","setFullName","emailAddress","setEmailAddress","password","setPassword","error","setError","isInvalid","handleSignUp","e","preventDefault","usernameExists","console","log","auth","createUserWithEmailAndPassword","createdUserResult","user","updateProfile","displayName","firestore","collection","add","userId","uid","toLowerCase","following","followers","dateCreated","Date","now","DASHBOARD","message","document","title","target","value","LOGIN"],"mappings":"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","sourcesContent":["/* eslint-disable import/named */\r\n/* eslint-disable no-shadow */\r\n/* eslint-disable no-restricted-globals */\r\n/* eslint-disable react/no-unescaped-entities */\r\n/* eslint-disable no-unused-vars */\r\nimport React, { useState, useContext, useEffect } from \"react\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport FirebaseContext from \"../context/firebase\";\r\nimport * as ROUTES from \"../constants/routes\";\r\nimport { doesUsernameExists } from \"../services/firebase\";\r\nimport \"firebase/compat/auth\";\r\nimport { firebase, FieldValue } from \"../lib/firebase\";\r\n\r\nexport default function SignUp() {\r\n  const history = useNavigate();\r\n  // const { firebase } = useContext(FirebaseContext);\r\n\r\n  const [username, setUsername] = useState(\"\");\r\n  const [fullName, setFullName] = useState(\"\");\r\n  const [emailAddress, setEmailAddress] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n\r\n  const [error, setError] = useState(\"\");\r\n  const isInvalid = password === \"\" || emailAddress === \"\";\r\n\r\n  const handleSignUp = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const usernameExists = await doesUsernameExists(username);\r\n    console.log(\"usernameExists\", usernameExists);\r\n\r\n    if (!usernameExists) {\r\n      try {\r\n        const createdUserResult = await firebase\r\n          .auth()\r\n          .createUserWithEmailAndPassword(emailAddress, password);\r\n\r\n        // authentication\r\n        // -> emailAddress & password & username (displayName)\r\n        await createdUserResult.user.updateProfile({\r\n          displayName: username,\r\n        });\r\n\r\n        // firebase user collection (create a document)\r\n        await firebase\r\n          .firestore()\r\n          .collection(\"users\")\r\n          .add({\r\n            userId: createdUserResult.user.uid,\r\n            username: username.toLowerCase(),\r\n            fullName,\r\n            emailAddress: emailAddress.toLowerCase(),\r\n            following: [\"2\"],\r\n            followers: [],\r\n            dateCreated: Date.now(),\r\n          });\r\n\r\n        history(ROUTES.DASHBOARD);\r\n      } catch (error) {\r\n        setFullName(\"\");\r\n        setEmailAddress(\"\");\r\n        setPassword(\"\");\r\n        setError(error.message);\r\n      }\r\n    } else {\r\n      setUsername(\"\");\r\n      setError(\"That username is already taken, please try another.\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.title = \"Sign Up - Instagram\";\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"container flex justify-center mx-auto max-w-screen-md items-center h-screen\">\r\n      <div className=\"flex w-3/5 hidden sm:block\">\r\n        <img\r\n          src=\"/images/iphone-with-profile.jpg\"\r\n          alt=\"iPhone with Instagram app\"\r\n        />\r\n      </div>\r\n      <div className=\"flex flex-col w-4/5 sm:w-2/5\">\r\n        <div className=\"flex flex-col items-center bg-white p-4 border border-gray-primary mb-4 rounded\">\r\n          <h1 className=\"flex justify-center w-full\">\r\n            <img\r\n              src=\"/images/logo.png\"\r\n              alt=\"Instagram\"\r\n              className=\"mt-2 w-6/12 mb-4\"\r\n            />\r\n          </h1>\r\n\r\n          {error && <p className=\"mb-4 text-xs text-red-primary\">{error}</p>}\r\n\r\n          <form onSubmit={handleSignUp} method=\"POST\">\r\n            <input\r\n              aria-label=\"Enter your username\"\r\n              type=\"text\"\r\n              placeholder=\"Username\"\r\n              className=\"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2\"\r\n              onChange={({ target }) => setUsername(target.value)}\r\n              value={username}\r\n            />\r\n            <input\r\n              aria-label=\"Enter your full name\"\r\n              type=\"text\"\r\n              placeholder=\"Full name\"\r\n              className=\"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2\"\r\n              onChange={({ target }) => setFullName(target.value)}\r\n              value={fullName}\r\n            />\r\n            <input\r\n              aria-label=\"Enter your email address\"\r\n              type=\"text\"\r\n              placeholder=\"Email address\"\r\n              className=\"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2\"\r\n              onChange={({ target }) => setEmailAddress(target.value)}\r\n              value={emailAddress}\r\n            />\r\n            <input\r\n              aria-label=\"Enter your password\"\r\n              type=\"password\"\r\n              placeholder=\"Password\"\r\n              className=\"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2\"\r\n              onChange={({ target }) => setPassword(target.value)}\r\n              value={password}\r\n            />\r\n            <button\r\n              disabled={isInvalid}\r\n              type=\"submit\"\r\n              className={`bg-blue-medium text-white w-full rounded h-8 font-bold\r\n            ${isInvalid && \"opacity-50\"}`}\r\n            >\r\n              Sign Up\r\n            </button>\r\n          </form>\r\n        </div>\r\n        <div className=\"flex justify-center items-center flex-col w-full bg-white p-4 rounded border border-gray-primary\">\r\n          <p className=\"text-sm\">\r\n            Â¿Have an account?{` `}\r\n            <Link to={ROUTES.LOGIN} className=\"font-bold text-blue-medium\">\r\n              Login\r\n            </Link>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}